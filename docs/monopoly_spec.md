РОЛЬ
Ты — автономный coding-агент. Твоя задача: создать в репозитории рабочий Python-проект “Монополия (боты-против-ботов)” с понятным Streamlit-интерфейсом наблюдателя. Проект должен быть читаемым, детерминируемым (seed), расширяемым для усиления ботов и строгим по правилам (кроме оговорённых исключений).

КЛЮЧЕВАЯ ЦЕЛЬ (MVP)
1) Запускается Streamlit-приложение, которое показывает:
   - поле (карта из 40 клеток в виде простой схемы/периметра),
   - фишки игроков, деньги, активы, ипотека, дома/отели, статус тюрьмы,
   - лог событий хода “человеческим русским”,
   - контроль симуляции: новая игра (N=2..6 ботов, seed), шаг хода, N шагов, автопрогон (опционально), скорость (если автопрогон есть).
2) Игра полностью играется 2–6 ботами (людей нет).
3) Полные правила “классической Монополии” (без сделок), включая:
   - тюрьма, дубль, 3 дубля → тюрьма, выход по штрафу/карте/дублю,
   - Шанс/Казна (эффекты), налоги, “Go”, “Go to Jail”, бесплатная парковка (пусто),
   - ипотека/выкуп, банкротства, переход активов,
   - правила застройки (равномерная застройка в группе, дома/отели), запреты на застройку при ипотеке и т.п.,
   - аукционы (см. ниже).
4) ДВА хоум-рула:
   HR1: НЕЛЬЗЯ покупать незанятую недвижимость по номиналу — ВСЕГДА запускается аукцион при попадании на незанятую собственность.
   HR2: Пока владелец в тюрьме — рента НЕ взимается (если игрок попал на собственность игрока, который сидит в тюрьме, платёж = 0). Остальные платежи (налоги/карты/штрафы) работают обычно.
5) Русификация UI/логов (все тексты интерфейса на русском).

ВАЖНО ПРО ЛОКАЛИЗАЦИЮ И КАРТОЧКИ (авторские права)
- Проект должен быть data-driven: данные поля, собственности и карточек загружаются из файлов (JSON/YAML).
- В репозитории можно положить “пример” (placeholder) русских названий/текстов.
- Сделай структуру так, чтобы пользователь мог САМ вставить точные русские тексты карточек и названия клеток в data-файлы (и всё сразу заработало).

ОГРАНИЧЕНИЯ И ПРИОРИТЕТЫ
- Один Python-проект (монолит). Никакого разделения backend/frontend. UI — Streamlit.
- Минимизируй зависимости. Достаточно: streamlit (+ по необходимости pydantic или ruamel/yaml, но лучше стандартная библиотека + PyYAML).
- Никаких “запасных путей”, лишних абстракций, фреймворков и микросервисов.
- Код: KISS/YAGNI. Но правила должны быть корректны.
- Пиши тесты на ядро (pytest), хотя бы на ключевые инварианты (аукцион обязателен, “рента=0 если владелец в тюрьме”, банкротство, дубль/тюрьма).
- Детерминизм: игра воспроизводится при одинаковом seed.

АРХИТЕКТУРА (обязательно)
A) Engine (ядро правил) — “чистый Python”
- Никаких вызовов Streamlit внутри ядра.
- Ядро предоставляет:
  - GameState (полное состояние),
  - метод step() или advance(action=None) (в идеале: state machine),
  - генерацию EventLog (список событий за шаг/ход).
- RNG: random.Random(seed) внутри GameState/Engine.

B) Event Log — контракт между движком и UI
- Каждое значимое действие порождает событие:
  TURN_START, DICE_ROLL, MOVE, LAND, AUCTION_START, AUCTION_BID, AUCTION_WIN,
  PAY_RENT, PAY_TAX, DRAW_CARD, CARD_EFFECT, GO_TO_JAIL, JAIL_TURN,
  BUILD, MORTGAGE, UNMORTGAGE, BANKRUPTCY, GAME_END и т.п.
- В каждом событии:
  - type (строка),
  - turn_index, player_id (если применимо),
  - msg_ru (короткое русское описание),
  - payload (словарь с деталями для UI).

C) Data-driven board/cards/rules
- data/board.yaml (или json): 40 клеток, типы клеток, группы/цвета, цены, ренты, стоимость домов, ипотека и т.д.
- data/cards_chance.yaml + data/cards_community.yaml: список карточек с полями:
  - id, text_ru (placeholder), effect (структурированное описание)
- data/rules.yaml: флаги правил, включая HR1, HR2, free_parking_empty=true, no_trades=true.
- По умолчанию можешь поставить “классические” числовые значения (если не уверен — оставь значения как конфиг и пометь TODO; но проект должен запускаться).

D) Bots
- Сейчас нужна минимальная реализация, чтобы партии шли:
  - В аукционе: базовая стратегия ставки.
  - Решения: платить ли штраф для выхода из тюрьмы, когда закладывать/выкупать, когда строить.
- Сделай API для ботов:
  - bot.decide(state, context) -> action
- Стили ботов (разные “характеры”) реализуй параметрами, даже если сила пока базовая:
  - Aggressive, Conservative, Builder, CashSaver (минимум 3–4).
- Позже пользователь будет усиливать до “сильных” (симуляции/MCTS/подбор параметров). Поэтому заложи:
  - быстрые копии состояния (или легковесный clone),
  - чистые функции оценки (scoring) без UI.

ПРАВИЛА (конкретика, которую нужно реализовать)
1) Ход игрока:
   - бросок 2d6,
   - если дубль: +ещё ход; 3 дубля подряд → тюрьма,
   - перемещение, обработка клетки.
2) Тюрьма:
   - “Just visiting” отдельно от “in jail”,
   - сидящий в тюрьме может:
     - пытаться выбросить дубль (до 3 ходов),
     - или платить штраф (обычно 50) (уточни по конфигу),
     - или использовать карточку выхода.
3) Собственность:
   - если попал на незанятую собственность → HR1: ВСЕГДА АУКЦИОН (все игроки могут участвовать, включая попавшего).
   - если попал на чужую собственность → рента, НО HR2: если владелец in_jail=true → рента=0.
   - монополии и застройка: равномерно, стоимость домов/отелей, запреты при ипотеке.
4) Аукцион (классический открытый повышающий):
   - начинается с минимальной цены (можно 1),
   - участники по очереди делают ставку выше текущей или пас,
   - когда остался 1 участник — он выигрывает, платит, получает собственность.
   - События AUCTION_* должны подробно отражать процесс.
5) Ипотека/банкротство:
   - если игрок должен заплатить и не хватает денег:
     - сначала может продавать дома/отели (по правилам, учитывая равномерность),
     - затем закладывать собственность,
     - если всё равно не может → банкротство.
   - При банкротстве:
     - активы переходят кредитору (или банку — если кредитор банк), с учётом ипотек (по правилам; допускается упростить, но тогда явно задокументировать выбранную трактовку в README и тестах).
6) Free Parking:
   - “ничего не происходит”.
7) Сделок нет:
   - никаких trade actions, обменов, договоров.

STREAMLIT UI (обязательный минимум)
- Главная страница:
  - Панель управления (sidebar):
    - число игроков (2–6),
    - seed (int),
    - выбор профиля ботов (например, список из N),
    - кнопки: “Новая игра”, “Шаг”, “+10 шагов”, “+100 шагов”, “Авто” (опционально), “Сброс”.
  - Основная область:
    - Простая визуализация поля 40 клеток (CSS grid или схематичный периметр).
      На клетках: имя, владелец (если есть), ипотека, дома/отели, маркер игроков.
    - Таблица игроков: деньги, позиция, в тюрьме?, число домов/отелей, стоимость активов.
    - Список собственности игрока (раскрывающийся).
    - Лента событий (последние N, на русском).
- UI НЕ должен зависеть от “ручных решений человека”: всё делает engine + боты.

КРИТЕРИИ ПРИЁМКИ (acceptance)
- `streamlit run app.py` (или `streamlit run monopoly/app.py`) запускается без ошибок.
- Можно создать игру на 2–6 ботов и прогнать минимум 200–500 шагов без падения.
- HR1 работает: при попадании на незанятую собственность НИКОГДА нет покупки по номиналу, ВСЕГДА аукцион.
- HR2 работает: если владелец в тюрьме, PAY_RENT не списывает деньги (или списывает 0) и лог явно это отражает.
- Free Parking пустой.
- Логи/интерфейс русские.
- Есть базовые тесты: хотя бы 5–10 тестов на ключевые случаи (аукцион обязателен, рента=0 в тюрьме, 3 дубля → тюрьма, детерминизм по seed, банкротство).

СТРУКТУРА РЕПО (предложение)
- monopoly/
  - __init__.py
  - engine.py (или engine/*)
  - models.py
  - bots.py
  - data/
    - board.yaml
    - cards_chance.yaml
    - cards_community.yaml
    - rules.yaml
  - ui_app.py (Streamlit)
- tests/
  - test_rules.py
- pyproject.toml (poetry/uv/pip-tools на твой выбор, но просто)
- README.md: как запустить, как заменить данные локализации, как добавить точные тексты карточек.

ПЛАН РАБОТЫ (делай коммитами, чтобы было видно прогресс)
1) Скелет проекта + Streamlit UI “пустышка” (показывает mock state).
2) Минимальный engine: игроки, кубики, перемещение, базовые клетки, event log.
3) Собственность + HR1 аукцион + базовый бот для ставок.
4) Рента + HR2, тюрьма/дубли.
5) Карточки (структурные эффекты) + placeholder тексты.
6) Ипотека/стройка/банкротства.
7) Полировка UI: карта, таблицы, лог.
8) Тесты и README.

ПРАВИЛА КОДА
- Принцип одной ответственности.
- Минимум магии. Простые dataclasses.
- Никаких “silent fallbacks”: если данные некорректны — явная ошибка на старте.
- Всё, что может быть конфигом, — конфиг (board/cards/rules).
- Везде, где нужен текст — русские строки.
- Не придумывай “сделки” и не добавляй их.
- Если где-то правило неоднозначно, выбери трактовку, зафиксируй в README и добавь тест. Не блокируй работу вопросами.

ВЫХОД
Когда закончишь, оставь в README:
- команды установки/запуска,
- как задать seed/ботов,
- где править названия клеток и тексты карточек,
- список реализованных правил + список допущений (если были).
